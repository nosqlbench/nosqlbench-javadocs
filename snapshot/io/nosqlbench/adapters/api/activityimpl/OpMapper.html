<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (23) -->
<title>OpMapper (nosqlbench 5.23.0-SNAPSHOT)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: io.nosqlbench.adapters.api.activityimpl, interface: OpMapper">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/OpMapper.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../search.html">Search</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<div class="about-language">nosqlbench 5.23.0-SNAPSHOT</div>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">io.nosqlbench.adapters.api.activityimpl</a></li>
<li><a href="OpMapper.html" class="current-selection">OpMapper</a></li>
</ol>
<div class="nav-list-search">
<input type="text" id="search-input" disabled placeholder="Search" aria-label="Search in documentation" autocomplete="off">
<input type="reset" id="reset-search" disabled value="Reset">
</div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;
<input type="text" class="filter-input" disabled placeholder="Filter" aria-label="Filter table of contents" autocomplete="off">
<input type="reset" class="reset-filter" disabled value="Reset">
</div>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span>&#10094;</button><button class="show-sidebar">&#10095;<span>&nbsp;Show sidebar</span></button>
<ol class="toc-list">
<li><a href="#" tabindex="0">Description</a>
<ol class="toc-list">
<li><a href="#synopsis-heading" tabindex="0">Synopsis</a></li>
<li><a href="#concepts-heading" tabindex="0">Concepts</a></li>
<li><a href="#implementation-strategy-heading" tabindex="0">Implementation Strategy</a></li>
<li><a href="#documentation-requirements-heading" tabindex="0">Documentation Requirements</a></li>
</ol>
</li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#implementation-notes-heading" tabindex="0">Implementation Notes</a></li>
<li><a href="#apply(io.nosqlbench.nb.api.components.core.NBComponent,io.nosqlbench.adapters.api.templating.ParsedOp,java.util.function.LongFunction)" tabindex="0">apply(NBComponent, ParsedOp, LongFunction)</a></li>
</ol>
</li>
</ol>
</nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Interface OpMapper" class="title">Interface OpMapper&lt;OPTYPE extends <a href="uniform/flowtypes/CycleOp.html" title="interface in io.nosqlbench.adapters.api.activityimpl.uniform.flowtypes">CycleOp</a>&lt;?&gt;,<wbr>SPACETYPE extends <a href="uniform/Space.html" title="interface in io.nosqlbench.adapters.api.activityimpl.uniform">Space</a>&gt;</h1>
</div>
<section class="class-description" id="class-description">
<div class="horizontal-scroll">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>OPTYPE</code> - The parameter type of the actual operation which will be used
     to hold all the details for executing an operation,
     generally something that implements <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link"><code>Runnable</code></a>.</dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="../../../adapter/amqp/AmqpOpMapper.html" title="class in io.nosqlbench.adapter.amqp">AmqpOpMapper</a></code>, <code><a href="../../../adapter/azureaisearch/AzureAISearchOpMapper.html" title="class in io.nosqlbench.adapter.azureaisearch">AzureAISearchOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4BaseOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4BaseOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/CqlD4BatchStmtMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">CqlD4BatchStmtMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4CoreOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4CoreOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4CqlBaseOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4CqlBaseOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4CqlOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4CqlOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/CqlD4CqlSimpleStmtMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">CqlD4CqlSimpleStmtMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4FluentGraphOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4FluentGraphOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/Cqld4GremlinOpMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">Cqld4GremlinOpMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/CqlD4PreparedStmtMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">CqlD4PreparedStmtMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/CqlD4RainbowTableMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">CqlD4RainbowTableMapper</a></code>, <code><a href="../../../adapter/cqld4/opmappers/CqlD4RawStmtMapper.html" title="class in io.nosqlbench.adapter.cqld4.opmappers">CqlD4RawStmtMapper</a></code>, <code><a href="../../../adapter/dataapi/DataApiOpMapper.html" title="class in io.nosqlbench.adapter.dataapi">DataApiOpMapper</a></code>, <code><a href="../../../adapter/diag/DiagOpMapper.html" title="class in io.nosqlbench.adapter.diag">DiagOpMapper</a></code>, <code><a href="../../../adapter/dynamodb/DynamoDBOpMapper.html" title="class in io.nosqlbench.adapter.dynamodb">DynamoDBOpMapper</a></code>, <code><a href="../../../adapter/prototype/ExampleOpMapper.html" title="class in io.nosqlbench.adapter.prototype">ExampleOpMapper</a></code>, <code><a href="../../../adapter/gcpspanner/GCPSpannerOpMapper.html" title="class in io.nosqlbench.adapter.gcpspanner">GCPSpannerOpMapper</a></code>, <code><a href="../../../adapter/http/core/HttpOpMapper.html" title="class in io.nosqlbench.adapter.http.core">HttpOpMapper</a></code>, <code><a href="../../../adapter/kafka/KafkaOpMapper.html" title="class in io.nosqlbench.adapter.kafka">KafkaOpMapper</a></code>, <code><a href="../../../adapter/mongodb/core/MongoOpMapper.html" title="class in io.nosqlbench.adapter.mongodb.core">MongoOpMapper</a></code>, <code><a href="../../../adapter/neo4j/Neo4JOpMapper.html" title="class in io.nosqlbench.adapter.neo4j">Neo4JOpMapper</a></code>, <code><a href="../../../adapter/pulsar/PulsarOpMapper.html" title="class in io.nosqlbench.adapter.pulsar">PulsarOpMapper</a></code>, <code><a href="../../../adapter/qdrant/QdrantOpMapper.html" title="class in io.nosqlbench.adapter.qdrant">QdrantOpMapper</a></code>, <code><a href="../../../adapter/s4j/S4JOpMapper.html" title="class in io.nosqlbench.adapter.s4j">S4JOpMapper</a></code>, <code><a href="../../../adapter/stdout/StdoutOpMapper.html" title="class in io.nosqlbench.adapter.stdout">StdoutOpMapper</a></code>, <code><a href="../../../adapter/tcpclient/TcpClientOpMapper.html" title="class in io.nosqlbench.adapter.tcpclient">TcpClientOpMapper</a></code>, <code><a href="../../../adapter/tcpserver/TcpServerOpMapper.html" title="class in io.nosqlbench.adapter.tcpserver">TcpServerOpMapper</a></code>, <code><a href="../../../adapter/weaviate/WeaviateOpMapper.html" title="class in io.nosqlbench.adapter.weaviate">WeaviateOpMapper</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">OpMapper&lt;OPTYPE extends <a href="uniform/flowtypes/CycleOp.html" title="interface in io.nosqlbench.adapters.api.activityimpl.uniform.flowtypes">CycleOp</a>&lt;?&gt;,<wbr>SPACETYPE extends <a href="uniform/Space.html" title="interface in io.nosqlbench.adapters.api.activityimpl.uniform">Space</a>&gt;</span></div>
<div class="block"><p>
 <h2 id="synopsis-heading">Synopsis</h2>
 An OpMapper is responsible for converting parsed op templates
 into dispensers of operations based on the intention of the user.
 <p>
 Op Templates as expressed as a set of field values, some literal, and
 some dynamic, to be generated based on a specific cycle value.
 </p>

 <p>
 <h2 id="concepts-heading">Concepts</h2>
 The OpMapper is basically a function that returns another function. The responsibility
 for creating executable operations is shared between the <a href="OpMapper.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpMapper</code></a> and the
 <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a>. The logic needed to determine the type of an operation intended
 by the user (mapping) is different from the logic you use to construct that specific
 type of operation once you know the intent (dispensing). If you look at a example
 of doing these together in code, there is always a point at which you know what is
 needed to construct an operation. If you draw a line at this point, it represents
 the separation of responsibilities between op mappers and op dispensers.
 </p>

 <p>This separation of responsibilities serves as both a conceptual clarification as
 well as a way to optimize runtime behavior. In the NoSQLBench model, all of the first step
 (mapping, the responsibility of this class) occurs at initialization time of an activity.
 This means that mapping logic can be as clear, readable, type-safe and obvious as
 possible without any negative effect on the later phase. In fact, clarity and obviousness
 at this level serves to keep implementations of the next phase much more straight-forward
 and streamlined, since all that is left to do is assemble the known elements together
 into an executable operation.</p>

 </hr>
 <h2 id="implementation-strategy-heading">Implementation Strategy</h2>
 <p>
 A view of an op template is provided in the <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating"><code>ParsedOp</code></a> API. This allows
 you to examine the fields provided by users. It also lets you see which
 of these fields are defined as dynamic and which are simply static values.
 When multiple types of operations are supported for a driver adapter, you must decide
 on a distinct signature

 </p>

 <p>
 <h2 id="documentation-requirements-heading">Documentation Requirements</h2>
 The logic which is implemented in the OpMapper must follow closely with the op construction
 rules provided to the user. Conversely, the driver maintainer should take care to provide
 rules of construction and examples in the documentation.
 Each <a href="uniform/DriverAdapter.html" title="interface in io.nosqlbench.adapters.api.activityimpl.uniform"><code>DriverAdapter</code></a> has a unique
 name. The documentation
 for each of these should be kept in the bundled resources in a top-level markdown file that
 matches the driver name.
 </p></div>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl">OpDispenser</a><wbr>&lt;? extends <a href="OpMapper.html" title="type parameter in OpMapper">OPTYPE</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#apply(io.nosqlbench.nb.api.components.core.NBComponent,io.nosqlbench.adapters.api.templating.ParsedOp,java.util.function.LongFunction)" class="member-name-link">apply</a><wbr>(<a href="../../../nb/api/components/core/NBComponent.html" title="interface in io.nosqlbench.nb.api.components.core">NBComponent</a>&nbsp;adapterC,
 <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating">ParsedOp</a>&nbsp;pop,
 <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/util/function/LongFunction.html" title="class or interface in java.util.function" class="external-link">LongFunction</a>&lt;<a href="OpMapper.html" title="type parameter in OpMapper">SPACETYPE</a>&gt;&nbsp;spaceF)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is responsible for interrogating the fields in the provided <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating"><code>ParsedOp</code></a> template object,
 determining what adapter-specific operation it maps to, and creating the associated <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a> for
 that type.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="apply(io.nosqlbench.nb.api.components.core.NBComponent,io.nosqlbench.adapters.api.templating.ParsedOp,java.util.function.LongFunction)">
<h3>apply</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type"><a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl">OpDispenser</a>&lt;? extends <a href="OpMapper.html" title="type parameter in OpMapper">OPTYPE</a>&gt;</span>&nbsp;<span class="element-name">apply</span><wbr><span class="parameters">(<a href="../../../nb/api/components/core/NBComponent.html" title="interface in io.nosqlbench.nb.api.components.core">NBComponent</a>&nbsp;adapterC,
 <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating">ParsedOp</a>&nbsp;pop,
 <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/util/function/LongFunction.html" title="class or interface in java.util.function" class="external-link">LongFunction</a>&lt;<a href="OpMapper.html" title="type parameter in OpMapper">SPACETYPE</a>&gt;&nbsp;spaceF)</span></div>
<div class="block">This method is responsible for interrogating the fields in the provided <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating"><code>ParsedOp</code></a> template object,
 determining what adapter-specific operation it maps to, and creating the associated <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a> for
 that type.

 <H2 id="implementation-notes-heading">Implementation Notes</H2>

 <P>It is important to be familiar with the structure of the <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating"><code>ParsedOp</code></a>, since this is the runtime model
 API for an op template. It provides everything you need to turn various op fields into proper lambdas, which
 can then be composed together to make higher-order lambdas. The returned <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a> is essentially
 a singular <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/util/function/LongFunction.html" title="class or interface in java.util.function" class="external-link"><code>LongFunction</code></a> which captures all of the just-in-time construction patterns needed within.</P>

 <H3 id="op-mapping-heading">Op Mapping</H3>
 <p>
 Generally speaking, implementations of this method should interrogate the op fields in the ParsedOp to determine
 the specific op that matches the user's intentions. It is <EM>Highly</EM> reccommended that each of the valid
 op types is presented as an example in the associated adapter documentation. (Each adapter must have a
 self-named markdown help file in it's source tree.) Good op mappers are based on specific examples which are
 documented, as this is the only way a user knows what op types are available.
 </p>

 <p>
 What determines the type of op can be based on something explicit, like the value of a <code>type</code> field, or it
 can be based on whether
 certain fields are present or not. Advanced implementations might take into account which fields are provided as
 static values and which are specified as (dynamic) bindings. The op mapping phase is meant to qualify and
 pre-check that the fields provided are valid and specific for a given type of operation.
 </p>

 <p>All of the effective logic for op mapping must be contained within the
 <a href="#apply(io.nosqlbench.nb.api.components.core.NBComponent,io.nosqlbench.adapters.api.templating.ParsedOp,java.util.function.LongFunction)"><code>apply(NBComponent, ParsedOp, LongFunction)</code></a> method. This includes what happens within the constructor of
 any <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a>. What happens within <a href="OpDispenser.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpDispenser</code></a> implementations (the second phase), however,
 should do as little qualification of field values as possible, focusing simply on constructing the type of
 operation for which they are designed. This suggest the following conventions:
 <UL>
 <LI>Type-mapping logic (determine which op type) is done in the main body of
 <a href="#apply(io.nosqlbench.nb.api.components.core.NBComponent,io.nosqlbench.adapters.api.templating.ParsedOp,java.util.function.LongFunction)"><code>apply(NBComponent, ParsedOp, LongFunction)</code></a>, and nothing else. Once the desired op dispenser (based on
 the intended op type) is determined, it is immediately constructed and returned.
 </LI>
 <LI>
 Lambda-construction logic is contained in the constructor of the returned op dispenser. This pre-bakes
 as much of the op construction behavior as possible, building only a single lambda to do the heavy lifting
 later.
 </LI>
 <LI>When <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/util/function/LongFunction.html#apply(long)" title="class or interface in java.util.function" class="external-link"><code>LongFunction.apply(long)</code></a></LI> is called with a cycle value, it only needs to call the lambda to
 return a fully-formed op, ready to be executed via its <a href="uniform/flowtypes/CycleOp.html#apply(long)"><code>CycleOp.apply(long)</code></a> method.
 </UL>
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>adapterC</code> - The adapter component. This is passed as an <a href="../../../nb/api/components/core/NBComponent.html" title="interface in io.nosqlbench.nb.api.components.core"><code>NBComponent</code></a> because it is not valid to rely
     on the driver adapter instance directly for anything. All logic for an op should be captured
     in its mapper and dispenser, and all (other) state for it should be captured within the space.
     However, the mapper exists within the nosqlbench runtime as part of the component tree, so it
     is included for that reason alone. (You'll need it for super construtors in some cases)</dd>
<dd><code>pop</code> - The <a href="../templating/ParsedOp.html" title="class in io.nosqlbench.adapters.api.templating"><code>ParsedOp</code></a> which is the parsed version of the user-provided op template. This contains all the
     fields provided by the user, as well as explicit knowledge of which ones are static and dynamic. It provides
     convenient lambda-construction methods to streamline the effort of creating the top-level op lambda.</dd>
<dd><code>spaceF</code> - This is the pre-baked lambda needed to access the specific <a href="OpMapper.html" title="interface in io.nosqlbench.adapters.api.activityimpl"><code>OpMapper</code></a> for a given cycle, if or when it
     is needed. Not all op types need this, since they may have all the state needed fully captured within the
     native type. For those that do, ensure that you are accessing the value through this function lazily and
     only within the stack. Using this function to do anything but build more lambdas is probably a
     programming error.</dd>
<dt>Returns:</dt>
<dd>An OpDispenser which can be used to synthesize directly executable operations.</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
